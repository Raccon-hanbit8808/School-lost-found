<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìš°ë¦¬ í•™êµ ë¶„ì‹¤ë¬¼ ì„¼í„°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700;800&display=swap');
        body { font-family: 'Nanum Gothic', sans-serif; background-color: #f8fafc; }
        .card { transition: all 0.2s ease-in-out; }
        .card:hover { transform: translateY(-4px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
        .tab-active { border-bottom: 3px solid #2563eb; color: #2563eb; font-weight: bold; }
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
    </style>
</head>
<body class="min-h-screen pb-20">

    <!-- Header -->
    <header class="bg-blue-600 text-white p-6 shadow-lg sticky top-0 z-30">
        <div class="max-w-5xl mx-auto flex justify-between items-center">
            <div>
                <h1 class="text-2xl font-bold flex items-center gap-2">
                    <span>ğŸ«</span> ìš°ë¦¬ í•™êµ ë¶„ì‹¤ë¬¼ ì„¼í„°
                </h1>
                <p class="text-blue-100 text-sm">êµë¬´ì‹¤ì— ë§¡ê²¨ì§„ ë¶„ì‹¤ë¬¼ì„ í™•ì¸í•˜ì„¸ìš”.</p>
            </div>
            <button onclick="openAdminAction('register')" class="bg-white text-blue-600 hover:bg-blue-50 px-5 py-2.5 rounded-xl font-extrabold transition shadow-md">
                + ìƒˆ ë¶„ì‹¤ë¬¼ ë“±ë¡
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-5xl mx-auto p-4 mt-4">
        
        <!-- Search & Filter -->
        <div class="bg-white p-5 rounded-2xl shadow-sm mb-8 flex flex-wrap gap-4 items-center border border-gray-100">
            <div class="flex-1 relative">
                <span class="absolute left-3 top-3 text-gray-400">ğŸ”</span>
                <input type="text" id="searchInput" oninput="renderItems()" placeholder="ë¬¼ê±´ ì´ë¦„ ë˜ëŠ” ì¥ì†Œë¡œ ê²€ìƒ‰..." class="w-full border border-gray-200 pl-10 pr-4 py-3 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-transparent transition">
            </div>
            <select id="filterCategory" onchange="renderItems()" class="border border-gray-200 px-4 py-3 rounded-xl outline-none bg-gray-50 font-medium cursor-pointer">
                <option value="ì „ì²´">ëª¨ë“  ì¹´í…Œê³ ë¦¬</option>
                <option value="í•™ìš©í’ˆ">í•™ìš©í’ˆ</option>
                <option value="ì˜ë¥˜">ì˜ë¥˜</option>
                <option value="ì „ìê¸°ê¸°">ì „ìê¸°ê¸°</option>
                <option value="ê°€ë°©/ì§€ê°‘">ê°€ë°©/ì§€ê°‘</option>
                <option value="ê¸°íƒ€">ê¸°íƒ€</option>
            </select>
        </div>

        <!-- Stats -->
        <div id="stats" class="mb-6 px-2 flex justify-between items-end">
            <span class="text-lg font-bold text-gray-700">ë¶„ì‹¤ë¬¼ ëª©ë¡</span>
            <span id="itemCount" class="text-sm text-gray-500 font-medium">ê²€ìƒ‰ ê²°ê³¼: 0ê±´</span>
        </div>

        <!-- Items Grid -->
        <div id="itemsGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Items will be rendered here -->
        </div>

        <!-- Empty State -->
        <div id="emptyState" class="hidden flex flex-col items-center justify-center py-24 text-gray-400">
            <div class="text-6xl mb-4">ğŸ“¦</div>
            <p class="text-xl">ë“±ë¡ëœ ë¶„ì‹¤ë¬¼ì´ ì—†ìŠµë‹ˆë‹¤.</p>
        </div>
    </main>

    <!-- Admin Password Check Modal -->
    <div id="passwordModal" class="fixed inset-0 bg-black/60 backdrop-blur-sm hidden flex items-center justify-center p-4 z-[60]">
        <div class="bg-white w-full max-w-sm rounded-3xl p-8 shadow-2xl text-center">
            <div class="text-4xl mb-4">ğŸ”’</div>
            <h2 class="text-xl font-bold text-gray-800 mb-2">ê´€ë¦¬ì í™•ì¸</h2>
            <p class="text-gray-500 text-sm mb-6">ë³´ì•ˆì„ ìœ„í•´ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.</p>
            <input type="password" id="adminPasswordInput" class="w-full border-2 border-gray-100 p-4 rounded-2xl text-center text-2xl tracking-widest focus:border-blue-400 outline-none mb-4" placeholder="****">
            <div class="flex gap-2">
                <button onclick="closePasswordModal()" class="flex-1 py-3 text-gray-500 font-bold hover:bg-gray-100 rounded-xl transition">ì·¨ì†Œ</button>
                <button onclick="checkPassword()" class="flex-1 py-3 bg-blue-600 text-white font-bold rounded-xl hover:bg-blue-700 transition">í™•ì¸</button>
            </div>
        </div>
    </div>

    <!-- Admin Registration Modal -->
    <div id="adminModal" class="fixed inset-0 bg-black/60 backdrop-blur-sm hidden flex items-center justify-center p-4 z-50 overflow-y-auto">
        <div class="bg-white w-full max-w-lg rounded-3xl overflow-hidden shadow-2xl my-auto">
            <div class="bg-blue-600 p-6 text-white flex justify-between items-center">
                <h2 class="text-xl font-bold">ìƒˆ ë¶„ì‹¤ë¬¼ ë“±ë¡</h2>
                <button onclick="toggleModal('adminModal')" class="text-2xl leading-none opacity-80 hover:opacity-100 transition">&times;</button>
            </div>
            
            <div class="flex border-b">
                <button onclick="switchTab('photo')" id="tabPhoto" class="flex-1 py-4 text-center tab-active transition">ì‚¬ì§„ìœ¼ë¡œ ë“±ë¡</button>
                <button onclick="switchTab('text')" id="tabText" class="flex-1 py-4 text-center text-gray-500 transition">ì œëª©ë§Œ ë“±ë¡</button>
            </div>

            <form id="itemForm" onsubmit="handleFormSubmit(event)" class="p-6 space-y-5">
                <!-- Image Upload Section -->
                <div id="imageSection" class="space-y-2">
                    <label class="block text-sm font-bold text-gray-700">ì‚¬ì§„ ì²¨ë¶€</label>
                    <div id="imagePreviewContainer" class="hidden relative h-48 w-full rounded-xl overflow-hidden bg-gray-100 border-2 border-dashed border-gray-300">
                        <img id="imagePreview" src="" class="h-full w-full object-cover">
                        <button type="button" onclick="clearImage()" class="absolute top-2 right-2 bg-black/50 text-white rounded-full w-8 h-8 flex items-center justify-center hover:bg-black/70 transition">Ã—</button>
                    </div>
                    <label id="uploadLabel" class="flex flex-col items-center justify-center h-48 w-full rounded-xl border-2 border-dashed border-gray-300 bg-gray-50 cursor-pointer hover:bg-gray-100 transition text-center px-4">
                        <span class="text-4xl mb-2">ğŸ“¸</span>
                        <span class="text-sm text-gray-500 font-bold">ë¶„ì‹¤ë¬¼ ì‚¬ì§„ì„ ì„ íƒí•˜ê±°ë‚˜ ì§ì ‘ ì´¬ì˜í•˜ì„¸ìš”</span>
                        <input type="file" id="itemPhoto" accept="image/*" onchange="previewFile()" class="hidden">
                    </label>
                </div>

                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-bold text-gray-700 mb-1">ë¬¼ê±´ ì´ë¦„</label>
                        <input type="text" id="itemName" required class="w-full border border-gray-200 p-3 rounded-xl focus:ring-2 focus:ring-blue-400 outline-none" placeholder="ì˜ˆ: íŒŒë€ìƒ‰ ë‚˜ì´í‚¤ í•„í†µ">
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-bold text-gray-700 mb-1">ìŠµë“ ë‚ ì§œ</label>
                            <input type="date" id="itemDate" required class="w-full border border-gray-200 p-3 rounded-xl outline-none">
                        </div>
                        <div>
                            <label class="block text-sm font-bold text-gray-700 mb-1">ì¹´í…Œê³ ë¦¬</label>
                            <select id="itemCategory" class="w-full border border-gray-200 p-3 rounded-xl outline-none">
                                <option value="í•™ìš©í’ˆ">í•™ìš©í’ˆ</option>
                                <option value="ì˜ë¥˜">ì˜ë¥˜</option>
                                <option value="ì „ìê¸°ê¸°">ì „ìê¸°ê¸°</option>
                                <option value="ê°€ë°©/ì§€ê°‘">ê°€ë°©/ì§€ê°‘</option>
                                <option value="ê¸°íƒ€">ê¸°íƒ€</option>
                            </select>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-bold text-gray-700 mb-1">ìŠµë“ ì¥ì†Œ</label>
                        <input type="text" id="itemLocation" required class="w-full border border-gray-200 p-3 rounded-xl outline-none" placeholder="ì˜ˆ: 2ì¸µ ë™í¸ ë³µë„">
                    </div>
                </div>

                <button type="submit" class="w-full bg-blue-600 text-white font-bold py-4 rounded-xl hover:bg-blue-700 shadow-lg shadow-blue-200 transition">
                    ë¶„ì‹¤ë¬¼ ë“±ë¡ ì™„ë£Œ
                </button>
            </form>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-10 left-1/2 transform -translate-x-1/2 bg-gray-900/90 text-white px-8 py-3.5 rounded-2xl opacity-0 transition-opacity duration-300 pointer-events-none z-[100] flex items-center gap-2">
        <span id="toastIcon">âœ…</span> <span id="toastMsg">ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤!</span>
    </div>

    <script>
        const ADMIN_PASSWORD = "1234"; // ê¸°ë³¸ ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸

        let currentTab = 'photo';
        let currentImageBase64 = null;
        let pendingAction = null; 
        
        // Initial Data
        let lostItems = [
            { id: 1, name: "ë…¸ë€ìƒ‰ ìºë¦­í„° í•„í†µ", date: "2023-10-25", location: "ê¸‰ì‹ì‹¤ ì•", category: "í•™ìš©í’ˆ", status: "ë³´ê´€ì¤‘", image: null },
            { id: 2, name: "ê²€ì€ìƒ‰ ì•„ë””ë‹¤ìŠ¤ ê°€ë°©", date: "2023-10-24", location: "ìš´ë™ì¥ ìŠ¤íƒ ë“œ", category: "ê°€ë°©/ì§€ê°‘", status: "ìˆ˜ë ¹ì™„ë£Œ", image: null }
        ];

        // Admin Action Access Control
        function openAdminAction(type, id = null) {
            pendingAction = { type, id };
            document.getElementById('passwordModal').classList.remove('hidden');
            document.getElementById('adminPasswordInput').focus();
        }

        function closePasswordModal() {
            document.getElementById('passwordModal').classList.add('hidden');
            document.getElementById('adminPasswordInput').value = "";
            pendingAction = null;
        }

        function checkPassword() {
            const input = document.getElementById('adminPasswordInput').value;
            if (input === ADMIN_PASSWORD) {
                const action = pendingAction;
                closePasswordModal();
                
                if (action.type === 'register') toggleModal('adminModal');
                else if (action.type === 'toggleStatus') executeToggleStatus(action.id);
                else if (action.type === 'delete') executeDeleteItem(action.id);
            } else {
                showToast("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.", "âŒ");
                document.getElementById('adminPasswordInput').value = "";
                document.getElementById('adminPasswordInput').focus();
            }
        }

        // Logic Functions
        function executeToggleStatus(id) {
            const item = lostItems.find(i => i.id === id);
            if (item) {
                const nextStatus = item.status === "ë³´ê´€ì¤‘" ? "ìˆ˜ë ¹ì™„ë£Œ" : "ë³´ê´€ì¤‘";
                item.status = nextStatus;
                renderItems();
                showToast(`[${item.name}] ìƒíƒœê°€ '${nextStatus}'ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.`, 'ğŸ’¡');
            }
        }

        function executeDeleteItem(id) {
            if (confirm("ì •ë§ë¡œ ì´ ë¶„ì‹¤ë¬¼ ê¸°ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                lostItems = lostItems.filter(i => i.id !== id);
                renderItems();
                showToast("ê¸°ë¡ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.", 'ğŸ—‘ï¸');
            }
        }

        function handleFormSubmit(e) {
            e.preventDefault();
            const newItem = {
                id: Date.now(),
                name: document.getElementById('itemName').value,
                date: document.getElementById('itemDate').value,
                location: document.getElementById('itemLocation').value,
                category: document.getElementById('itemCategory').value,
                status: "ë³´ê´€ì¤‘",
                image: currentTab === 'photo' ? currentImageBase64 : null
            };
            lostItems.unshift(newItem);
            renderItems();
            toggleModal('adminModal');
            document.getElementById('itemForm').reset();
            clearImage();
            showToast("ì„±ê³µì ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.");
        }

        // UI Utility Functions
        function toggleModal(id) {
            const modal = document.getElementById(id);
            modal.classList.toggle('hidden');
            if (!modal.classList.contains('hidden')) {
                document.getElementById('itemDate').valueAsDate = new Date();
                switchTab('photo');
            }
        }

        function switchTab(type) {
            currentTab = type;
            const tabPhoto = document.getElementById('tabPhoto');
            const tabText = document.getElementById('tabText');
            const imageSection = document.getElementById('imageSection');
            if (type === 'photo') {
                tabPhoto.classList.add('tab-active');
                tabText.classList.remove('tab-active');
                tabText.classList.add('text-gray-500');
                imageSection.classList.remove('hidden');
            } else {
                tabText.classList.add('tab-active');
                tabPhoto.classList.remove('tab-active');
                tabPhoto.classList.add('text-gray-500');
                imageSection.classList.add('hidden');
                clearImage();
            }
        }

        function previewFile() {
            const file = document.getElementById('itemPhoto').files[0];
            const reader = new FileReader();
            reader.onloadend = () => {
                currentImageBase64 = reader.result;
                document.getElementById('imagePreview').src = reader.result;
                document.getElementById('imagePreviewContainer').classList.remove('hidden');
                document.getElementById('uploadLabel').classList.add('hidden');
            };
            if (file) reader.readAsDataURL(file);
        }

        function clearImage() {
            currentImageBase64 = null;
            document.getElementById('itemPhoto').value = "";
            document.getElementById('imagePreviewContainer').classList.add('hidden');
            document.getElementById('uploadLabel').classList.remove('hidden');
        }

        function renderItems() {
            const grid = document.getElementById('itemsGrid');
            const empty = document.getElementById('emptyState');
            const search = document.getElementById('searchInput').value.toLowerCase();
            const category = document.getElementById('filterCategory').value;
            
            const filtered = lostItems.filter(item => {
                const matchesSearch = item.name.toLowerCase().includes(search) || item.location.toLowerCase().includes(search);
                const matchesCategory = category === "ì „ì²´" || item.category === category;
                return matchesSearch && matchesCategory;
            });

            filtered.sort((a, b) => new Date(b.date) - new Date(a.date));
            document.getElementById('itemCount').textContent = `ê²€ìƒ‰ ê²°ê³¼: ${filtered.length}ê±´`;

            if (filtered.length === 0) {
                grid.innerHTML = "";
                empty.classList.remove('hidden');
            } else {
                empty.classList.add('hidden');
                grid.innerHTML = filtered.map(item => `
                    <div class="card bg-white rounded-3xl shadow-sm border border-gray-100 overflow-hidden flex flex-col h-full">
                        <div class="relative h-48 bg-gray-50">
                            ${item.image 
                                ? `<img src="${item.image}" alt="${item.name}" class="w-full h-full object-cover">`
                                : `<div class="w-full h-full flex flex-col items-center justify-center text-gray-300">
                                     <span class="text-4xl mb-1">ğŸ”</span>
                                     <span class="text-xs font-bold italic">ì´ë¯¸ì§€ ì—†ìŒ</span>
                                   </div>`
                            }
                            <div class="absolute top-4 left-4">
                                <span class="px-2.5 py-1 rounded-lg text-[10px] font-black tracking-tight uppercase shadow-sm ${
                                    item.category === 'í•™ìš©í’ˆ' ? 'bg-yellow-400 text-yellow-900' :
                                    item.category === 'ì˜ë¥˜' ? 'bg-green-400 text-green-900' :
                                    item.category === 'ì „ìê¸°ê¸°' ? 'bg-indigo-400 text-white' : 
                                    item.category === 'ê°€ë°©/ì§€ê°‘' ? 'bg-orange-400 text-white' : 'bg-gray-400 text-white'
                                }">
                                    ${item.category}
                                </span>
                            </div>
                            ${item.status === 'ìˆ˜ë ¹ì™„ë£Œ' ? `
                                <div class="absolute inset-0 bg-black/50 backdrop-blur-[1px] flex items-center justify-center">
                                    <div class="border-4 border-white text-white font-black px-4 py-2 text-xl rotate-[-10deg] rounded-xl">ì°¾ì•„ê° ì™„ë£Œ</div>
                                </div>
                            ` : ''}
                        </div>
                        
                        <div class="p-6 flex-1 flex flex-col">
                            <h3 class="text-lg font-extrabold text-gray-800 mb-2 leading-tight">${item.name}</h3>
                            <div class="space-y-1.5 mb-6 text-sm text-gray-500">
                                <div class="flex items-center"><span class="w-6">ğŸ“…</span> <span>${item.date} ìŠµë“</span></div>
                                <div class="flex items-center"><span class="w-6">ğŸ“</span> <span>${item.location}</span></div>
                            </div>
                            
                            <div class="mt-auto flex gap-2">
                                <button onclick="openAdminAction('toggleStatus', ${item.id})" class="flex-1 py-3 text-xs font-bold rounded-xl transition shadow-sm ${
                                    item.status === 'ë³´ê´€ì¤‘' 
                                    ? 'bg-blue-50 text-blue-600 border border-blue-100 hover:bg-blue-600 hover:text-white' 
                                    : 'bg-gray-100 text-gray-500 border border-gray-100 hover:bg-gray-200'
                                }">
                                    ${item.status === 'ë³´ê´€ì¤‘' ? 'ì°¾ì•„ê° ì™„ë£Œ ì²˜ë¦¬' : 'ë³´ê´€ì¤‘ìœ¼ë¡œ ë˜ëŒë¦¬ê¸°'}
                                </button>
                                <button onclick="openAdminAction('delete', ${item.id})" class="bg-red-50 text-red-400 px-3 rounded-xl border border-red-50 hover:bg-red-500 hover:text-white transition">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
        }

        function showToast(msg, icon = 'âœ…') {
            const toast = document.getElementById('toast');
            document.getElementById('toastMsg').textContent = msg;
            document.getElementById('toastIcon').textContent = icon;
            toast.classList.remove('opacity-0');
            setTimeout(() => toast.classList.add('opacity-0'), 3000);
        }

        window.onload = renderItems;
        document.getElementById('adminPasswordInput').addEventListener('keypress', (e) => { if (e.key === 'Enter') checkPassword(); });
    </script>
</body>
</html>
